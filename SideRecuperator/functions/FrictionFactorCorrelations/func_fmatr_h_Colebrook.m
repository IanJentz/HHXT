function fmatrix = func_fmatr_h_Colebrook(Re)
% Colebrook relation for Darcy friction factor, using a wall relative
% roughness of 0.1

    % note the outputs and inputs are arrays with form:
    % cfcore = [f_x;f_y;f_z]
    % Re = [Re_x;Re_y;Re_z]
    Re_x = Re(1,:); % reynolds is given as an array with x and y values
    
    % using Colebrook relation:
    % 1/sqrt(f) = -2.0*log10( (RR/3.7) + (2.51/(Re*sqrt(f))) )
    % the Colebrook relation has been pre-solved over Re = 2000 to 200000
    % using a relative roughness RR = 0.1
    Re_d = [2000;2197;2414;2651;2913;3200;3515;3861;4242;4660;5119;5624;6178;6786;7455;8190;8997;9883;10857;11927;13103;14394;15812;17370;19082;20962;23028;25297;27790;30528;33537;36841;40472;44460;48841;53654;58941;64749;71130;78139;85839;94297;103589;113797;125011;137330;150862;165729;182060;200000];
    y = [0.109500000000000;0.108800000000000;0.108200000000000;0.107600000000000;0.107100000000000;0.106600000000000;0.106200000000000;0.105800000000000;0.105400000000000;0.105100000000000;0.104800000000000;0.104500000000000;0.104300000000000;0.104000000000000;0.103800000000000;0.103600000000000;0.103500000000000;0.103300000000000;0.103200000000000;0.103000000000000;0.102900000000000;0.102800000000000;0.102700000000000;0.102600000000000;0.102500000000000;0.102400000000000;0.102400000000000;0.102300000000000;0.102200000000000;0.102200000000000;0.102100000000000;0.102100000000000;0.102100000000000;0.102000000000000;0.102000000000000;0.102000000000000;0.101900000000000;0.101900000000000;0.101900000000000;0.101900000000000;0.101800000000000;0.101800000000000;0.101800000000000;0.101800000000000;0.101800000000000;0.101800000000000;0.101800000000000;0.101800000000000;0.101700000000000;0.101700000000000];
    val = interp1(Re_d,y,Re_x); % interpolate our Moody chart line
    
    val(Re_x<Re_d(1)) = 64./Re_x(Re_x<Re_d(1)); % below Re_d(1) we will use the laminar relation f_D = 64/Re 
    val(Re_x>Re_d(end)) = y(end); % anything above Re(end) will just be set to the value at Re(end)
    
    fmatrix = [val;100*val];  % we determine the friction factor in the x direction, y and z directions are arbitrily set high

end